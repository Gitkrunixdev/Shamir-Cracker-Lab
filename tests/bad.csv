def test_missing_required_fields(tmp_path): 
csv_content = "date,symbol\n2025-01-01,ABC\n" 
data_dir = tmp_path / "data" 
data_dir.mkdir() 
csv_file = data_dir / "bad.csv" 
csv_file.write_text(csv_content, encoding="utf-8") 
res = run_pipeline(str(csv_file), out_dir=str(tmp_path / "reports"), base_name="bad") 
assert res["status"] == "error" 
assert res["error_type"] == "InputDataValidationError"
